<div class="cinema-index-background">
  <div class="container">
    <div class="row">
      <div class="col">

        <div class="profile-contents">

          <div class="profile-top">
            <div class="profile-image-name">
              <div class="profile-image">
                <% if current_user.profile_picture.attached? %>
                  <%= cl_image_tag current_user.profile_picture.key, class: "profile-picture" %>
                <% else %>
                  <%= image_tag "profile-icon.jpg", alt: "Profile image", class: "profile-pic" %>
                <% end %>
              </div>

              <div class="profile-username">
                <h2> <%= current_user.username %> </h2>
              </div>
            </div>

            <%# <div>
              <%= link_to "Edit Profile", edit_user_registration_path, class: "edit-profile" %>
            <%# </div> %>
            <%# <div class="profile-sign-out">
              <% if user_signed_in? %>
                <%# <%= button_to 'Log Out', destroy_user_session_path, method: :delete, class: "btn btn-danger" %>
              <%# <% end %>

              <div class="profile-actions">
                <%= link_to "Edit", edit_user_registration_path, class: "edit-profile" %>

                <% if user_signed_in? %>
                  <%= link_to 'Log Out', destroy_user_session_path, method: :delete, class: "log-out" %>
                <% end %>
              </div>

            </div>
          </div>

          <div class="profile-bio">
            <div>
              <p> Bio: </p>
            </div>
            <div class="profile-bio-edit">
              <%= current_user.bio %>
            </div>
          </div>

          <div class="profile-top-picks">
            <h2>Your top rated</h2>

            <% if @top_cinemas.any? %>
              <% @top_cinemas.each do |cinema| %>
                <%= link_to cinema_path(cinema), class: "top-pick-card" do %>
                <%# <div class="top-pick-card"> %>
                  <img src="<%= cinema.image_url %>" />
                  <div class="top-pick-details">
                    <h4><%= cinema.name %></h4>
                    <p><%= cinema.address %></p>
                    <p>Average rating: <%= cinema.avg_rating.present? ? cinema.avg_rating.round(2) : 'No reviews yet' %></p>
                  </div>
                <%# </div> %>
                <% end %>
              <% end %>
            <% else %>
              <p>You haven't reviewed any cinemas yet.</p>
            <% end %>
          </div>

          <div class="profile-past-reviews">
            <h3> Your reviews </h3>
            <% current_user.reviews.each do |review| %>
              <%#= render partial: 'cinemas/review', locals: { review: review } %>
                <%= link_to render(partial: 'cinemas/review', locals: { review: review }), cinema_path(review.cinema) %>
            <% end %>
          </div>

          <%#= cl_image_tag @article.photo.key, height: 300, width: 400, crop: :fill %>
        </div>
      </div>
    </div>
  </div>
</div>

<%# <div class="home-login"> %>
  <%# <% if user_signed_in? %>
    <%# <p>Welcome, <%= current_user.username !</p>
    <%# <%= button_to 'Log Out', destroy_user_session_path, method: :delete, class: "btn btn-danger" %>
  <%# <% else %>
    <%# <div class="home-login-btn"> %>
      <%# <%= link_to 'Log In', new_user_session_path, class: "btn btn-primary" %>
    <%# </div> %>
    <%# <div class="home-signup-btn"> %>
      <%# <p>Don't have an account?</p> %>
      <%# <%= link_to 'Sign Up', new_user_registration_path, class: "btn btn-success" %>
    <%# </div> %>
  <%# <% end %>
<%# </div> %>
